# 批量视频空间使用指南

## 🎯 功能介绍

**批量视频空间**是一个Excel表格式的高效视频批量管理界面，专为大批量视频生成优化。

### 核心优势
- ✅ **高信息密度**: 一屏显示8-10个任务（vs 当前2个）
- ✅ **CSV批量导入**: 5分钟创建50个任务
- ✅ **表格式编辑**: 直观高效，类似Excel
- ✅ **智能显示**: 单图/视频直显，多个折叠

---

## 🚀 快速开始

### 步骤1：进入批量空间
```
视频空间 → 点击工具栏的[📊 表格视图]按钮
```

### 步骤2：创建任务

#### 方法A：手动创建
```
点击[➕ 新建行] → 在表格中逐行填写
```

#### 方法B：CSV导入（推荐）⭐
```
1. 用Excel编辑 video_batch_template.csv
2. 点击[📥 导入CSV]
3. 选择CSV文件
4. 确认导入
```

### 步骤3：批量生成
```
点击[⚡ 批量生成] → 所有任务开始并发生成
```

---

## 📊 表格列说明

### 列结构
```
┌──┬────────┬───────────────────────────────┬────────┬──────────┐
│# │  图片   │           提示词               │  视频   │   设置    │
│  │        │                               │        │          │
│40│  140px │          700px ⭐⭐⭐          │  140px │  240px   │
│px│        │                               │        │          │
└──┴────────┴───────────────────────────────┴────────┴──────────┘
```

### 1. 序号列（40px）
- 自动排序（1, 2, 3...）
- 不可编辑

### 2. 图片列（140px）
```
单张图片: [📷]
  - 点击 → 查看大图
  - 点击 → 添加更多图片

多张图片: [📷][3]
  - 点击图片 → 查看第一张
  - 点击数字 → 展开查看所有
  - 详情面板显示完整列表
```

### 3. 提示词列（700px）⭐
```
可编辑文本框:
  - 直接点击输入
  - 支持2行显示
  - 超长自动换行
  - 实时保存
```

### 4. 视频列（140px）
```
未生成: "等待生成"

单个视频: [▶️]
  - 点击 → 播放视频

多个视频: [▶️][5]
  - 点击图标 → 播放第一个
  - 点击数字 → 展开查看所有
  - 详情面板显示完整列表
```

### 5. 设置列（240px）- 两排布局
```
第一排: [比例▼] [时长▼]
第二排: [批量±] [🗑️]

每个元素占据 120px × 32px
```

---

## ⚙️ 设置区详解

### 第一排：比例 + 时长

#### 比例下拉
```
选项:
  ⚡ 自动 - 使用工作流/API默认值（ComfyUI推荐）
  16:9 - 横屏（1280x720 或 1920x1080）
  9:16 - 竖屏（720x1280 或 1080x1920）
  1:1 - 方形（720x720 或 1080x1080）
  4:3 - 传统横屏
  3:4 - 传统竖屏

⚡ 自动模式:
  - ComfyUI: 不传width/height，用工作流设置
  - API: 不传size参数，用API默认值
```

#### 时长下拉
```
选项:
  ⚡ 自动 - 使用工作流/API默认值（ComfyUI推荐）
  5秒 - 短视频
  10秒 - 标准长度
  15秒 - 长视频

⚡ 自动模式:
  - ComfyUI: 不传frames，用工作流设置
  - API: 不传duration参数，用API默认值
```

### 第二排：批量 + 删除

#### 批量调整
```
[- 2 +]
  - 点击[-] 减少
  - 点击[+] 增加
  - 范围: 1-20
  
批量设置为5 → 生成5个视频
```

#### 删除按钮
```
[🗑️]
  - 点击 → 删除整行
  - 不可恢复
```

---

## 📥 CSV导入功能

### CSV格式
```csv
提示词,比例,时长,批量,参考图片
```

### 示例文件
```csv
提示词,比例,时长,批量,参考图片
猫咪在奔跑,自动,自动,2,
狗狗在玩耍,16:9,10秒,3,C:\images\dog.jpg
兔子在跳跃,9:16,15秒,1,C:\images\rabbit1.jpg|C:\images\rabbit2.jpg
女孩在唱歌,自动,自动,5,
```

### 字段说明

#### 提示词（必填）
```
示例: "猫咪在奔跑，眼睛很大"
注意: 如果包含逗号，用双引号包裹
      "猫咪在奔跑，眼睛很大，穿着衣服"
```

#### 比例（可选）
```
支持值: 自动, 16:9, 9:16, 1:1, 4:3, 3:4
默认值: 自动
无效值: 自动替换为"自动"并警告
```

#### 时长（可选）
```
支持值: 自动, 5秒, 10秒, 15秒
默认值: 自动
无效值: 自动替换为"自动"并警告
```

#### 批量（可选）
```
支持值: 1-20的数字
默认值: 1
无效值: 小于1改为1，大于20改为20
```

#### 参考图片（可选）
```
单张图片: C:\images\cat.jpg
多张图片: C:\images\cat1.jpg|C:\images\cat2.jpg|C:\images\cat3.jpg

分隔符: | (竖线)
路径无效: 自动跳过并警告
```

---

## 📤 CSV导出功能

### 使用方法
```
1. 点击[📤 导出CSV]
2. 选择保存位置
3. 输入文件名（默认带时间戳）
4. 保存
```

### 导出内容
```
包含当前表格所有任务:
  - 提示词
  - 比例设置
  - 时长设置
  - 批量数量
  - 参考图片路径
```

### 用途
- 💾 备份任务配置
- 🔄 在不同设备间同步
- 👥 分享给团队成员
- 📋 创建任务模板库

---

## 🎨 详情面板

### 展开方式
```
点击表格中的任意一行 → 底部展开详情面板
再次点击 → 收起
```

### 详情内容
```
┌─────────────────────────────────────────┐
│ 任务 3 详情                      [✕关闭] │
├─────────────────────────────────────────┤
│ 📷 参考图片 (3)                          │
│ [图1] [图2] [图3] [➕添加]               │
│                                         │
│ 🎬 生成视频 (5)                          │
│ [▶️1] [▶️2] [▶️3] [▶️4] [▶️5]             │
└─────────────────────────────────────────┘
```

#### 功能
- ✅ 查看所有参考图片
- ✅ 添加/删除图片
- ✅ 查看所有生成的视频
- ✅ 播放视频

---

## 💡 使用技巧

### 技巧1：Excel快速编辑
```
1. 用Excel打开 video_batch_template.csv
2. 复制粘贴提示词（从文档、网页等）
3. 使用Excel的填充功能批量设置比例
4. 保存为CSV（UTF-8编码）
5. 导入到应用
```

### 技巧2：批量设置图片
```
如果50个任务都用同一张参考图:

Excel中:
  拖动第一行的图片路径 → 填充到所有行
  
结果:
  所有任务自动使用同一张图片
```

### 技巧3：任务分组
```
CSV中按主题分组:

# 自然风景组（比例16:9）
春天的花园,16:9,10秒,2,
夏天的海滩,16:9,10秒,2,
秋天的森林,16:9,10秒,2,

# 人物特写组（比例9:16）
女孩在唱歌,9:16,5秒,3,
男孩在跳舞,9:16,5秒,3,

导入后一目了然！
```

### 技巧4：ComfyUI用户
```
全部设置为"自动":

提示词,比例,时长,批量,参考图片
任务1,自动,自动,2,
任务2,自动,自动,3,
任务3,自动,自动,1,

完全按工作流配置生成，避免参数冲突
```

---

## ⚠️ 注意事项

### CSV编码
```
❌ 错误: Excel默认保存为GBK编码
        导入后中文乱码

✅ 正确: 保存为UTF-8编码
        文件 → 另存为 → 编码选UTF-8
```

### 图片路径
```
✅ 推荐: 绝对路径
        C:\Users\...\image.jpg

⚠️ 避免: 相对路径（可能找不到）
        ..\images\cat.jpg
        
💡 提示: 把图片集中放在一个文件夹
        C:\VideoAssets\references\
```

### 批量数量控制
```
建议单次总视频数:
  🟢 1-30个: 非常稳定
  🟡 30-60个: 需要耐心（1-2小时）
  🔴 60+个: 建议分批（可能超时）

计算方法:
  任务数 × 每任务批量 = 总视频数
  10任务 × 批量3 = 30个视频 ✅
```

---

## 🎊 功能清单

### 顶部工具栏
- [x] 🔙 返回 - 回到普通视频空间
- [x] 📥 导入CSV - 批量导入任务
- [x] 📤 导出CSV - 导出当前任务
- [x] ⚡ 批量生成 - 执行所有任务
- [x] 🗑️ 清空面板 - 删除所有任务
- [x] ➕ 新建行 - 添加空白行

### 表格功能
- [x] 序号 - 自动排序
- [x] 图片 - 添加/删除/查看
- [x] 提示词 - 直接编辑
- [x] 视频 - 播放/查看
- [x] 设置 - 比例/时长/批量/删除

### 智能特性
- [x] "自动"选项 - 适配ComfyUI
- [x] 智能显示 - 单个直显，多个折叠
- [x] 导入验证 - 自动修正无效值
- [x] 详情面板 - 展开查看完整信息

---

## 📋 CSV模板位置

```
assets/video_batch_template.csv
```

### 使用方法
1. 复制模板文件
2. 用Excel打开
3. 修改提示词和参数
4. 另存为（UTF-8编码）
5. 在应用中导入

---

## 🎯 效率对比

### 创建50个任务

#### 当前卡片式
```
操作: 点击50次"新建任务"
      逐个填写提示词
      逐个设置参数

耗时: ~30分钟
点击: 200+次
```

#### 批量空间（手动）
```
操作: 点击50次"新建行"
      在表格中逐行填写

耗时: ~15分钟
点击: 100+次
```

#### 批量空间（CSV导入）
```
操作: Excel编辑 → 导入CSV

耗时: ~5分钟 ✅
点击: 3次 ✅

效率提升: 6倍！
```

---

## 💡 最佳实践

### 1. 建立提示词库
```
创建多个CSV模板:
  - nature_scenes.csv（自然风景）
  - character_actions.csv（人物动作）
  - abstract_art.csv（抽象艺术）

需要时直接导入，无需重新编辑
```

### 2. 分批生成
```
不要一次导入100个任务，建议:

第1批: 导入20个 → 批量生成 → 等待完成
第2批: 导入20个 → 批量生成 → 等待完成
...

稳定可靠，避免超时
```

### 3. 使用"自动"选项
```
ComfyUI用户:
  比例: 自动
  时长: 自动
  
  避免参数冲突，完全按工作流设置

API用户:
  比例: 明确指定（16:9等）
  时长: 明确指定（10秒等）
  
  精确控制输出
```

---

## 🔍 常见问题

### Q1: 导入后提示"警告"
```
原因: CSV中有无效值（比例、时长、批量等）

解决: 
  - 应用已自动修正为有效值
  - 查看警告列表，确认是否符合预期
  - 可以在表格中手动调整
```

### Q2: 图片路径无效
```
原因: CSV中的图片路径不存在

解决:
  - 应用会跳过无效路径并警告
  - 可以在详情面板中重新添加图片
```

### Q3: 批量生成失败
```
原因: API未配置或ComfyUI未运行

解决:
  1. 检查 设置 → API设置 → 视频模型
  2. 确认服务商配置正确
  3. ComfyUI用户确认服务已启动
```

---

## 📊 布局示意图

### 完整界面
```
┌──────────────────────────────────────────────────────────┐
│ 🔙批量空间  [📥][📤][⚡][🗑️][➕]                            │ ← 工具栏
├──┬───────┬────────────────────────────┬───────┬──────────┤
│# │ 图片   │          提示词             │ 视频   │  设置     │ ← 表头
├──┼───────┼────────────────────────────┼───────┼──────────┤
│1 │ [📷]  │猫咪在奔跑，眼睛很大...      │ [▶️]  │16:9 10秒 │
│  │       │                            │       │ 2   🗑️  │
├──┼───────┼────────────────────────────┼───────┼──────────┤
│2 │[📷][2]│狗狗在玩耍，尾巴摇摆...      │[▶️][3]│自动 自动 │
│  │       │                            │       │ 5   🗑️  │
├──┼───────┼────────────────────────────┼───────┼──────────┤
│3 │       │[输入提示词...]              │       │16:9 5秒  │
│  │       │                            │       │ 1   🗑️  │
└──┴───────┴────────────────────────────┴───────┴──────────┘
│                                                           │
│ 📷 参考图片 (3)  [图1] [图2] [图3] [➕]                  │ ← 详情面板
│ 🎬 生成视频 (5)  [▶️1] [▶️2] [▶️3] [▶️4] [▶️5]           │  （点击行展开）
└──────────────────────────────────────────────────────────┘
```

---

## 🎊 总结

### 批量空间的核心价值

✨ **10倍信息密度** - 2个任务 → 20个任务/屏
✨ **6倍创建效率** - CSV导入 vs 手动创建
✨ **Excel式操作** - 直观易用，上手即会
✨ **专业级工具** - 适合大批量视频创作

### 适合人群
- ✅ 需要批量生成大量视频
- ✅ 熟悉Excel操作
- ✅ 追求高效率
- ✅ 团队协作需求

---

**创建时间**: 2026-02-03
**功能状态**: ✅ 已实现
**模板位置**: `assets/video_batch_template.csv`
