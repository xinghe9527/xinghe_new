# å‘å¸ƒæ¸…å• - å¿«é€Ÿå‚è€ƒ

## ğŸ“‹ é¦–æ¬¡å‘å¸ƒï¼ˆç‰ˆæœ¬ 1.0.0ï¼‰

### âœ… å·²å®Œæˆ
- [x] ä»£ç å¼€å‘å®Œæˆ
- [x] Release æ„å»ºå®Œæˆ
- [x] å®‰è£…ç¨‹åºå·²ç”Ÿæˆï¼š`installer_output\æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.0.exe`

### â¬œ å¾…å®Œæˆ
- [ ] é…ç½® Supabase è¡¨ï¼ˆæ‰§è¡Œ SQLï¼‰
- [ ] åˆ›å»º Storage Bucket
- [ ] ä¸Šä¼ å®‰è£…åŒ…åˆ° Storageï¼ˆå¯é€‰ï¼‰
- [ ] æµ‹è¯•å®‰è£…ç¨‹åº

---

## ğŸ”„ å‘å¸ƒæ›´æ–°ç‰ˆæœ¬ï¼ˆ1.0.1, 1.0.2...ï¼‰

### æ­¥éª¤1ï¼šå‡†å¤‡æ–°ç‰ˆæœ¬

```powershell
# 1. ä¿®æ”¹ç‰ˆæœ¬å·
# ç¼–è¾‘ pubspec.yaml: version: 1.0.X+X

# 2. æ„å»º
flutter clean
flutter build windows --release

# 3. åˆ›å»ºå®‰è£…åŒ…
"C:\Program Files (x86)\Inno Setup 6\ISCC.exe" installer-script.iss
```

**è¾“å‡ºï¼š** `installer_output\æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.X.exe`

---

### æ­¥éª¤2ï¼šä¸Šä¼ åˆ° Supabase

```
1. Supabase Dashboard
2. Storage â†’ app-updates
3. Upload: æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.X.exe
4. å¤åˆ¶ URL
```

**URL æ ¼å¼ï¼š**
```
https://tnmbprizergdjrirehyi.supabase.co/storage/v1/object/public/app-updates/æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.X.exe
```

---

### æ­¥éª¤3ï¼šå‘å¸ƒæ›´æ–°ï¼ˆSQLï¼‰

**é‡è¦ï¼šå¤åˆ¶ä¸‹é¢çš„ SQL æ¨¡æ¿ï¼Œä¿®æ”¹ç‰ˆæœ¬å·å’Œ URL**

```sql
INSERT INTO app_versions (
  version, 
  min_version,       -- âš ï¸ ä¿®æ”¹ç‰ˆæœ¬å·
  force_update, 
  update_package_url, -- âš ï¸ ä¿®æ”¹ URL
  update_log,        -- âš ï¸ ä¿®æ”¹æ›´æ–°å†…å®¹
  file_size,         -- âš ï¸ ä¿®æ”¹æ–‡ä»¶å¤§å°
  is_active
) VALUES (
  '1.0.1',           -- âš ï¸ æ”¹è¿™é‡Œï¼šæ–°ç‰ˆæœ¬å·
  '1.0.1',           -- âš ï¸ æ”¹è¿™é‡Œï¼šå’Œä¸Šé¢ç›¸åŒ
  true,
  'https://tnmbprizergdjrirehyi.supabase.co/storage/v1/object/public/app-updates/æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.1.exe',
  'æ›´æ–°å†…å®¹ï¼š
- æ–°å¢XXXåŠŸèƒ½
- ä¿®å¤YYYé—®é¢˜
- ä¼˜åŒ–æ€§èƒ½',
  58000000,          -- âš ï¸ æ”¹è¿™é‡Œï¼šå®é™…æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  true
);
```

**âœ… æ‰§è¡Œåï¼Œæ‰€æœ‰æ—§ç‰ˆæœ¬ç«‹å³å¤±æ•ˆï¼**

---

## âš¡ å¿«é€Ÿå‚è€ƒ

### è·å–æ–‡ä»¶å¤§å°

```powershell
# æŸ¥çœ‹å®‰è£…åŒ…å¤§å°
(Get-Item "installer_output\æ˜Ÿæ©™AIåŠ¨æ¼«åˆ¶ä½œ_Setup_1.0.X.exe").Length
```

### æŸ¥çœ‹å½“å‰æ¿€æ´»çš„ç‰ˆæœ¬

```sql
SELECT version, min_version, is_active, created_at
FROM app_versions
WHERE is_active = true
ORDER BY created_at DESC;
```

### ç¦ç”¨ç‰ˆæœ¬ï¼ˆç´§æ€¥å›æ»šï¼‰

```sql
UPDATE app_versions 
SET is_active = false 
WHERE version = '1.0.1';
```

---

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### æ¨¡å¼3 é…ç½®è§„åˆ™ï¼š

```
version = min_version = force_update = true
   â†“           â†“              â†“
æ–°ç‰ˆæœ¬å·    æ–°ç‰ˆæœ¬å·    å¼ºåˆ¶æ›´æ–°
          (ç›¸åŒ)

ğŸ‘† è¿™æ ·é…ç½®ï¼Œè€ç‰ˆæœ¬ç«‹å³å¤±æ•ˆï¼
```

---

## ğŸ“Š ç‰ˆæœ¬æ¼”è¿›ç¤ºä¾‹

```
Day 1:  å‘å¸ƒ 1.0.0 â†’ min_version='1.0.0'
Day 10: å‘å¸ƒ 1.0.1 â†’ min_version='1.0.1' â† 1.0.0 å¤±æ•ˆ
Day 20: å‘å¸ƒ 1.0.2 â†’ min_version='1.0.2' â† 1.0.0 å’Œ 1.0.1 éƒ½å¤±æ•ˆ
Day 30: å‘å¸ƒ 2.0.0 â†’ min_version='2.0.0' â† æ‰€æœ‰ 1.x ç‰ˆæœ¬å¤±æ•ˆ
```

**ç»“æœï¼šæ‰€æœ‰ç”¨æˆ·å§‹ç»ˆä¿æŒåœ¨æœ€æ–°ç‰ˆæœ¬**

---

## ğŸ›¡ï¸ å®‰å…¨æç¤º

### API Key å®‰å…¨

å½“å‰æ–¹æ¡ˆï¼š
- âœ… Supabase Key åœ¨åº”ç”¨ä¸­ï¼ˆè®¾è®¡ä¸Šå¯å…¬å¼€ï¼‰
- âœ… ç¬¬ä¸‰æ–¹ API Key ä¸åœ¨åº”ç”¨ä¸­
- âœ… ç”¨æˆ·éœ€è¦è‡ªå·±é…ç½® API Key
- âœ… å®Œå…¨å®‰å…¨

### æ›´æ–°å®‰å…¨

- âœ… Supabase RLS ä¿æŠ¤æ•°æ®åº“
- âœ… åªæœ‰ä½ å¯ä»¥æ’å…¥æ–°ç‰ˆæœ¬
- âœ… ç”¨æˆ·åªèƒ½è¯»å–ç‰ˆæœ¬ä¿¡æ¯
- âœ… ä¸‹è½½é“¾æ¥æŒ‡å‘ä½ çš„ Supabase Storage

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q: ç”¨æˆ·ç‚¹å‡»"ç«‹å³æ›´æ–°"åä¼šæ€æ ·ï¼Ÿ

A: 
1. æµè§ˆå™¨æ‰“å¼€ä¸‹è½½é“¾æ¥
2. ç”¨æˆ·ä¸‹è½½æ–°å®‰è£…åŒ…
3. ç”¨æˆ·è¿è¡Œå®‰è£…åŒ…
4. è¦†ç›–å®‰è£…
5. å®Œæˆ

### Q: ç”¨æˆ·å¯ä»¥è·³è¿‡æ›´æ–°å—ï¼Ÿ

A: 
- å¼ºåˆ¶æ›´æ–°ï¼ˆæ¨¡å¼3ï¼‰ï¼šä¸èƒ½è·³è¿‡ï¼Œå¯¹è¯æ¡†æ— æ³•å…³é—­
- ä¸æ›´æ–°å°±æ— æ³•ä½¿ç”¨åº”ç”¨

### Q: å¦‚ä½•æµ‹è¯•ï¼Ÿ

A: 
1. å®‰è£… 1.0.0 ç‰ˆæœ¬
2. åœ¨ Supabase æ’å…¥ 1.0.1 ç‰ˆæœ¬ä¿¡æ¯
3. è¿è¡Œ 1.0.0 ç‰ˆæœ¬
4. åº”è¯¥å¼¹å‡ºå¼ºåˆ¶æ›´æ–°å¯¹è¯æ¡†

### Q: æ›´æ–°å¤šä¹…ç”Ÿæ•ˆï¼Ÿ

A: ç«‹å³ï¼æ’å…¥ SQL åï¼Œç”¨æˆ·ä¸‹æ¬¡å¯åŠ¨åº”ç”¨å°±ä¼šæ£€æµ‹åˆ°ã€‚

---

## ğŸ‰ æ€»ç»“

**ä½ çš„å®Œæ•´å·¥ä½œæµï¼š**

```
å¼€å‘æ–°åŠŸèƒ½
    â†“
æ”¹ç‰ˆæœ¬å·ï¼ˆpubspec.yamlï¼‰
    â†“
flutter build windows --release
    â†“
ç¼–è¯‘å®‰è£…ç¨‹åºï¼ˆInno Setupï¼‰
    â†“
ä¸Šä¼ åˆ° Supabase Storage
    â†“
æ‰§è¡Œ SQLï¼ˆversion = min_versionï¼‰
    â†“
âœ… å®Œæˆï¼è€ç‰ˆæœ¬å¤±æ•ˆï¼Œç”¨æˆ·å¿…é¡»æ›´æ–°
```

**30 åˆ†é’Ÿå®Œæˆä¸€æ¬¡æ›´æ–°å‘å¸ƒï¼**

---

**è¯¦ç»†æ–‡æ¡£ï¼š**
- `AUTO_UPDATE_SETUP.md` - å®Œæ•´é…ç½®æŒ‡å—
- `VERSION_CONTROL_GUIDE.md` - ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥
- `SUPABASE_UPDATE_SETUP.sql` - æ•°æ®åº“è„šæœ¬

**ä¸‹ä¸€æ­¥ï¼šé…ç½® Supabaseï¼** ğŸš€
